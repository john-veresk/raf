# Task: Add PR Creation from Worktree

## Objective
Add the ability to create a GitHub Pull Request from a worktree branch using the `gh` CLI tool.

## Dependencies
002

## Context
Currently, after completing tasks in a worktree, the only automated option is merging the branch back. This task adds PR creation as an alternative workflow. The PR body should be a Claude-generated summary combining the project's input.md, key decisions, and task outcomes.

## Requirements
- Use `gh pr create` CLI command to create PRs
- Auto-detect the base branch (the branch the worktree was forked from, typically main)
- PR title derived from the project name (human-readable, from the folder name)
- PR body generated by Claude (Haiku model) summarizing: input.md content, key decisions from decisions.md, and outcomes from completed tasks
- Handle errors gracefully: `gh` not installed, not authenticated, repo not on GitHub, etc.
- The PR creation function should be a reusable utility in `src/core/` that the `do` command can call

## Implementation Steps
1. Create a new module `src/core/pull-request.ts` with the PR creation logic
2. Implement base branch detection — determine which branch the worktree was forked from (likely stored or derivable from git)
3. Implement PR body generation — read input.md, decisions.md, and outcome files, then call Claude Haiku to generate a clean summary
4. Implement the `gh pr create` call — construct the command with title, body, base branch, and head branch
5. Add error handling for common failure modes (gh not installed, auth issues, non-GitHub remote)
6. Add prerequisite check: verify `gh` CLI is available and authenticated before attempting PR creation
7. Write tests for the PR creation module (mock `gh` CLI calls)

## Acceptance Criteria
- [ ] PR creation works from a worktree branch
- [ ] PR title is clean and derived from project name
- [ ] PR body is a Claude-generated summary of input + decisions + outcomes
- [ ] Base branch is auto-detected correctly
- [ ] Graceful error handling when gh is not available or not authenticated
- [ ] Tests cover the PR creation flow
- [ ] All existing tests pass

## Notes
- The `gh` CLI must be installed and authenticated (`gh auth status`) for this to work
- PR body generation uses Claude Haiku for cost efficiency
- The head branch name is the project folder name (e.g., `021b5g-merge-guardian`)
- This module will be consumed by the post-execution picker (task 004)
- Consider adding a check that the branch has been pushed to the remote before creating the PR — `gh pr create` may handle this automatically
